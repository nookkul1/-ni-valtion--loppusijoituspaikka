#SingleInstance Force

; Base64 koodattu kuva
Image =
(Join
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
)

Gui, +ToolWindow +AlwaysOnTop
Gui, add, picture,, % "HBITMAP:" h := GDI_Startup(Image) ; Lisää puretun kuvan GUI ikkunaan
Gui, Show, , kilroy is here
WinSet Style, -0xC00000, kilroy is here ; Poistaa ikkunan otsikkorivin
WinSet, TransColor, 0xF0F0F0 255, kilroy is here
Gui, Hide
SetTimer, Peek, 50
Sleep, 10000
Gui, Show, NoActivate, kilroy is here
return

Peek:
WinGetPos, X, Y,,, A
Y := Y - 80
WinMove, kilroy is here,, %X%, %Y%

; Base64 koodatun kuvan purkaminen lainattu jostain
GDI_Startup(Base64) {
hGdip := DllCall("Kernel32.dll\LoadLibrary", "Str", "Gdiplus.dll") ; Load module
VarSetCapacity(GdiplusStartupInput, (A_PtrSize = 8 ? 24 : 16), 0) ; GdiplusStartupInput structure
NumPut(1, GdiplusStartupInput, 0, "UInt") ; GdiplusVersion
VarSetCapacity(pToken, 0) ;Make var big enough to fit contents
DllCall("Gdiplus.dll\GdiplusStartup", "PtrP", pToken, "Ptr", &GdiplusStartupInput, "Ptr", 0) ; Initialize GDI+
BMP := GdipCreateFromBase(Base64) ;Turn the raw data into an image. 
DllCall("Kernel32.dll\FreeLibrary", "Ptr", hGdip) ; Free GDI+ module from memory
Return BMP 
}
		
		GdipCreateFromBase(B64, IsIcon := 0) {
			VarSetCapacity(B64Len, 0)
			DllCall("Crypt32.dll\CryptStringToBinary", "Ptr", &B64, "UInt", StrLen(B64), "UInt", 0x01, "Ptr", 0, "UIntP", B64Len, "Ptr", 0, "Ptr", 0)
			VarSetCapacity(B64Dec, B64Len, 0) ; pbBinary size
			DllCall("Crypt32.dll\CryptStringToBinary", "Ptr", &B64, "UInt", StrLen(B64), "UInt", 0x01, "Ptr", &B64Dec, "UIntP", B64Len, "Ptr", 0, "Ptr", 0)
			pStream := DllCall("Shlwapi.dll\SHCreateMemStream", "Ptr", &B64Dec, "UInt", B64Len, "UPtr")
			VarSetCapacity(pBitmap, 0)
			DllCall("Gdiplus.dll\GdipCreateBitmapFromStreamICM", "Ptr", pStream, "PtrP", pBitmap)
			VarSetCapacity(hBitmap, 0)
			DllCall("Gdiplus.dll\GdipCreateHBITMAPFromBitmap", "UInt", pBitmap, "UInt*", hBitmap, "Int", 0XFFFFFFFF)
			If (IsIcon) 
				DllCall("Gdiplus.dll\GdipCreateHICONFromBitmap", "Ptr", pBitmap, "PtrP", hIcon, "UInt", 0)
			ObjRelease(pStream)
			return (IsIcon ? hIcon : hBitmap)
		}
